"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const node_fs=require("node:fs"),vite=require("vite"),O=require("gray-matter"),tinyglobby=require("tinyglobby"),vitepress=require("vitepress"),node_path=require("node:path"),e=require("picocolors");function _interopDefaultCompat(t){return t&&typeof t=="object"&&"default"in t?t.default:t}const O__default=_interopDefaultCompat(O),e__default=_interopDefaultCompat(e),version="1.0.12",logger=vite.createLogger("info",{prefix:`[vitepress-plugin-file-content-loader v${version}]`}),info=(t,r="green",n={timestamp:!0})=>{logger.info(e__default[r](t),n)},warn=(t,r="yellow",n={timestamp:!0})=>{logger.warn(e__default[r](t),n)},warnOnce=(t,r="yellow",n={timestamp:!0})=>{logger.info(e__default[r](t),n)},error=(t,r="red",n={timestamp:!0})=>{logger.error(e__default[r](t),n)},S={info,warn,warnOnce,error},DEFAULT_IGNORE_DIR=["**/node_modules/**","**/dist/**"];function j(t){let r=!1;return{name:"vite-plugin-vitepress-file-content-loader",async config(n){if(r)return;r=!0;let{pattern:o}=t;if(!o)return;const{includeSrc:v=!1,render:h=!1,excerpt:s,transformData:d,transformRaw:f,globOptions:p,themeConfigKey:a="contentLoader"}=t,{site:{themeConfig:w={},base:x},srcDir:c,cleanUrls:D,markdown:b}=n.vitepress;typeof o=="string"&&(o=[o]),o=o.map(i=>vite.normalizePath(node_path.join(c,i)));const q=(await tinyglobby.glob(o,{expandDirectories:!1,...p,ignore:["**/node_modules/**","**/dist/**",...p?.ignore||[]]})).sort(),m=await vitepress.createMarkdownRenderer(c,b,x,logger),l=[];for(const i of q){if(!i.endsWith(".md"))continue;const u=node_fs.readFileSync(i,"utf-8"),{data:E,excerpt:_}=O__default(u,typeof s=="string"?{excerpt_separator:s}:{excerpt:s}),R="/"+vite.normalizePath(node_path.relative(c,i)).replace(/(^|\/)index\.md$/,"$1").replace(/\.md$/,D?"":".html"),$=h?m.render(u):void 0,C=s&&_?.endsWith(`
`)?m.render(_):void 0,y={src:v?u:void 0,html:$,frontmatter:E,excerpt:C,url:R};l.push(d?await d(y):y)}w[a]=f?await f(l):l;const g=a.charAt(0).toUpperCase()+a.slice(1);S.info(`Injected ${g} Data Successfully. \u6CE8\u5165 ${g} \u6570\u636E\u6210\u529F!`)}}}exports.DEFAULT_IGNORE_DIR=DEFAULT_IGNORE_DIR,exports.default=j;
